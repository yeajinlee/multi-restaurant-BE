<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<!-- <mapper namespace="mappers.newlist">
	<resultMap type="newListVO" id="newListResult">
		<result property="rest_NO" column="rest_NO"/>
		<result property="rest_Name" column="rest_Name"/>
		<result property="rest_Price" column="rest_Price"/>
		<result property="rest_Address" column="rest_Address"/>
		<result property="rest_Scope" column="rest_Scope"/>
		<result property="rest_Social" column="rest_View"/>
		<result property="rest_fileName" column="rest_fileName"/>
		<result property="rest_OpenDate" column="rest_OpenDate"/>
	</resultMap>
		<resultMap type="newListVO" id="defaultListResult">
		<result property="rest_NO" column="rest_NO"/>
		<result property="rest_Name" column="rest_Name"/>
		<result property="rest_Price" column="rest_Price"/>
		<result property="rest_Address" column="rest_Address"/>
		<result property="rest_Scope" column="rest_Scope"/>
		<result property="rest_Social" column="rest_View"/>
		<result property="rest_fileName" column="rest_fileName"/>
		<result property="rest_OpenDate" column="rest_OpenDate"/>
	</resultMap>
		<select id="selectNewList" resultMap="newListResult">
		<![CDATA[
select ri.rest_NO, ri.rest_Name, ri.rest_Price, ri.rest_Address, ri.rest_fileName, ri.rest_Scope 
from Restaurant_Info ri, User_Info ui where ri.rest_Address=ui.user_city order by rest_OpenDate
		]]>
	</select>
			<select id="defaultNewList" resultMap="defaultListResult">
		<![CDATA[
select ri.rest_NO, ri.rest_Name, ri.rest_Price, ri.rest_Address, ri.rest_fileName, ri.rest_Scope 
from Restaurant_Info ri order by rest_OpenDate
		]]>
	</select>
	
	
	</mapper> -->
	
	<mapper namespace="mappers.newList">
		<resultMap type="newListVO" id="newListResult">
			<result property="rest_NO" column="rest_NO"/>
			<result property="rest_Name" column="rest_Name"/>
			<result property="rest_Price" column="rest_Price"/>
			<result property="rest_Address" column="rest_Address"/>
			<result property="rest_Scope" column="rest_Scope"/>
			<result property="rest_FileName" column="rest_FileName"/>
			<result property="rest_Theme" column="rest_Theme"/>
			<result property="rest_OpenDate" column="rest_OpenDate"/>
			<result property="review_Cnt" column="review_Cnt"/>
		</resultMap>
		<select id="selectNewList" resultMap="newListResult">
			<![CDATA[
				select a.rest_NO, a.rest_name, a.rest_price, a.rest_address, a.rest_scope, a.rest_filename, a.rest_theme, a.rest_opendate, b.review_cnt
				from (
				(select rest_NO, rest_name, rest_price, rest_address, rest_scope, rest_filename, rest_theme, 
				rest_opendate from restaurant_info order by rest_opendate desc) a
				left outer join (select rest_no, count(*) as review_cnt from review_info group by rest_no) b on a.rest_no = b.rest_no) 
				where review_cnt is null
			]]>
		</select>
	</mapper>